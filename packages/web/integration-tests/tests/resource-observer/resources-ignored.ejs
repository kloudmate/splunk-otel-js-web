<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Resource observer ignore test</title>

  <%- renderAgent({}, true) %>
    <script>
      window.KloudmateRumOptions.ignoreUrls = [
        window.location.origin + '/utils/devServer/assets/kloudmate-black.png',
        /test.js/
      ];
      window.KloudmateRum && window.KloudmateRum.init(window.KloudmateRumOptions);
    </script>
</head>

<body>
  <h1>Resource observer ignore test</h1>

  <script>

    function loadScript() {
      var p = new Promise(function (resolve, _) {
        var s = document.createElement('script');
        s.setAttribute('src', '/utils/devServer/assets/test.js');
        s.onload = resolve;
        document.body.appendChild(s);
      });
      return p;
    }

    function loadImg() {
      var p = new Promise(function (resolve, _) {
        var img = document.createElement('img');
        img.src = '/utils/devServer/assets/kloudmate-black.png';
        img.onload = resolve;
        document.body.appendChild(img);
      });
      return p;
    }

    window.addEventListener("load", function () {
      Promise.all([loadImg(), loadScript()]).then(function () {
        KloudmateRum.provider.getTracer('default').startSpan('guard-span').end();
      })
    })
  </script>

</body>

</html>